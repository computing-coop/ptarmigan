.carousel
  - @carousel.each do |slide|
    .slide
      = image_tag slide.image.url(:largest)
      .caption
        %span.category
          - if slide.class == Flicker
            = t :archive
            = ": "
          - if slide.class == Event
            = t "madhouse.event"
            = ": "
          
        %span.title
          = link_to slide.name,  url_for(slide.carousel_link)
        .date.text-left
          = slide.carousel_date.empty? ? '' : slide.carousel_date.map{|x| l x, :format => :long}.join(' - ')
             
.upcoming_events.row{:"data-equalizer" => ''}
  
  .text-center
    %h3= t "madhouse.upcoming_events"
  - @upcoming.take(9).each_with_index do |event, index|
    = link_to event do
      .small-10.small-offset-1.medium-offset-0.medium-6.large-4.xlarge-3.columns.event{:"data-equalizer-watch" => '', class: (index == 8 ? 'show-for-large-only' : (index > 3 ? 'hide-for-medium-only hide-for-small-only' : false) )}
        .top_box
          = event.title
          .date= date_range(event.date, event.enddate)
        .description{style: (event.avatar? ? "background: url(#{event.avatar.url(:medium)}) center center;" : false)}= truncate_html(event.description, length: 180)
    
- unless @posts.empty?
  .front_posts_container
    .row
      - column_count = 3
      .latest_post_container.columns.large-3.small-10.small-offset-1.medium-offset-0
        .inner
          %h3= t("madhouse.latest_news")
          - @posts.take(4).each do |post|
            .post_entry
              .title= link_to post.title, post
              .date= timeago_tag post.published_at

      - @posts.each do |post|
        - if column_count >= 12
          - column_count = 0
          
        - if post.alternateimg_aspect? == :portrait || !post.alternateimg?
          - column_count += 3
        - else
          - column_count += 6
        = link_to post do
          %div{class: column_count == 0 ? :rowd  : :nothing}
            .single_post.columns.small-10.small-offset-1.medium-offset-0{class: [post.alternateimg? ? (post.alternateimg_aspect? == :portrait ? 'medium-6 large-3' : (column_count > 12 ? "medium-#{post.alternateimg_width > 900 ? 12 : 6}  large-3" : "medium-6  large-6")) : 'medium-6 large-3', post == @posts.last && column_count < 12 ? 'hide-for-large-up' : false]}
              .inner{style: post.alternateimg? ? "background: url(http://ptarmigan.fi#{post.alternateimg.url(:full)}) no-repeat center center; background-size: cover;" : ''}
                %h3= post.title
                .date
                  = t("madhouse.posted_by", poster: post.is_personal == true ? post.user.name : 'Mad House', when: l(post.published_at.to_date, format: :long))



= content_for :jquery do
  :plain

    $('.carousel').slick({
        dots: true,
        autoplay: true,
        autoplaySpeed: 5500
      })
      
      
      